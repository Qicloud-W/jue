import{D as U,E as M,a as N,F as T,b as z,G as A,g as D}from"./element-plus-DEgQ78-a.js";import{u as G,b as k,n as V,d as $,e as H,_ as O}from"./index-CYWUNeU5.js";import{u as C}from"./vue-router-MJGgZ6ro.js";import{e as W,_ as j}from"./LoginLeft-DkxJ_TY_.js";import{d as E,i as f,m as x,H as J,o as R,M as K,O as n,a as m,u as e,W as t,T as I,U as S,bn as F,bl as L,c as P,a0 as Q}from"./@vue-AVcRlItG.js";import{f as X}from"./@vueuse-80B0Z04t.js";import"./lodash-es-25cZ6aDd.js";import"./async-validator-DKvM95Vc.js";import"./dayjs-D7ajE0Qg.js";import"./clipboard-CJr-i2j9.js";import"./@element-plus-Bh_lnI-E.js";import"./@ctrl-r5W6hzzQ.js";import"./@popperjs-D9SI2xQl.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./pinia-DsZbUfLd.js";import"./pinia-plugin-persistedstate-n2tMOXAx.js";import"./axios-BdQ6k-vz.js";import"./nprogress-Dnjw-PvA.js";import"./markdown-it-4Tp5vWU9.js";import"./mdurl-k9Sl0PQj.js";import"./uc.micro-XL2UFyD4.js";import"./entities-C20TfXL6.js";import"./linkify-it-BpOB9kmn.js";import"./punycode.js-Dj65hjkv.js";import"./crypto-js-BOfVfFwP.js";import"./vue3-danmaku-DA_6354Q.js";import"./plyr-DMguYs3u.js";import"./viewerjs-ul8fLQ7-.js";import"./highlight.js-DnQT8WiG.js";import"./@unhead-CE7b8z0V.js";import"./unhead-BIJBGSS1.js";import"./hookable-B8xFkYCm.js";const Y=i=>(F("data-v-90c5410c"),i=i(),L(),i),Z=Y(()=>m("div",{class:"fs-28 white-color fw-600 mb5"},"注  册",-1)),ee={style:{height:"20px"}},oe={class:"flex-yc g-2 w-100"},te=E({__name:"RegisterForm",setup(i){const a=f(60),v=G(),w=C(),c=f(),d=f(!1),u=f(!1),o=x({email:"",account:"",nickname:"",password:"",re_password:"",code:""}),{pause:g,resume:h}=X(()=>{a.value--,a.value<=0&&(a.value=60,g())},1e3,{immediate:!0}),q=x({account:[{required:!0,message:"账号或邮箱不能为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{pattern:W,message:"邮箱格式不正确",trigger:"blur"}],re_password:[{required:!0,message:"请重复密码",trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]}),b={handleRegister:async()=>{const p=c.value;p&&p.validate(async s=>{if(s){d.value=!0;try{const r=await k.register(o.email,void 0,o.password,o.nickname,o.code);r.code===200?(U({title:"注册成功",message:`欢迎你，${r.data.user.nickname}！`,type:"success"}),b.afterLogin(r.data)):V(r)}finally{d.value=!1}}})},getRegistercode:async()=>{if(!o.email)return M.warning("邮箱不能为空");u.value=!0;try{const p=await k.register(o.email);p.code===201&&(a.value=a.value-1,h()),V(p)}finally{u.value=!1}},afterLogin:p=>{v.setLogin(p),w.push("/")}};return J(()=>{g()}),(p,s)=>{const r=N,_=T,y=z,B=A;return R(),K(B,{"hide-required-asterisk":"",ref_key:"loginFormRef",ref:c,model:e(o),class:"login-body pr",rules:e(q),"label-position":"top"},{default:n(()=>[Z,m("div",ee,[m("div",{onClick:s[0]||(s[0]=l=>e(w).push({name:"Login"})),class:"mb-2 login-tip fs-12 curp hvco"}," 已有账号？返回登录 ")]),t(_,{prop:"email",class:"mt-2"},{default:n(()=>[t(r,{modelValue:e(o).email,"onUpdate:modelValue":s[1]||(s[1]=l=>e(o).email=l),placeholder:"请输入邮箱",clearable:""},null,8,["modelValue"])]),_:1}),t(_,{prop:"nickname"},{default:n(()=>[t(r,{modelValue:e(o).nickname,"onUpdate:modelValue":s[2]||(s[2]=l=>e(o).nickname=l),placeholder:"请输入昵称",clearable:""},null,8,["modelValue"])]),_:1}),t(_,{prop:"password"},{default:n(()=>[t(r,{clearable:"","show-password":"",modelValue:e(o).password,"onUpdate:modelValue":s[3]||(s[3]=l=>e(o).password=l),type:"password",placeholder:"请输入登录密码"},null,8,["modelValue"])]),_:1}),t(_,{prop:"re_password"},{default:n(()=>[t(r,{clearable:"","show-password":"",modelValue:e(o).re_password,"onUpdate:modelValue":s[4]||(s[4]=l=>e(o).re_password=l),type:"password",placeholder:"请确认登录密码"},null,8,["modelValue"])]),_:1}),t(_,{prop:"code"},{default:n(()=>[m("div",oe,[t(r,{clearable:"",class:"w-100",modelValue:e(o).code,"onUpdate:modelValue":s[5]||(s[5]=l=>e(o).code=l),placeholder:"请输入验证码"},null,8,["modelValue"]),t(y,{type:"primary",loading:e(u),disabled:e(a)<60,plain:"",onClick:b.getRegistercode},{default:n(()=>[I(S(e(a)===60?"获取验证码":`${e(a)}s`),1)]),_:1},8,["loading","disabled","onClick"])])]),_:1}),t(y,{type:"primary",onClick:b.handleRegister,loading:e(d),class:"w-100 mt-4"},{default:n(()=>[I(S(e(d)?"提交中":"注  册"),1)]),_:1},8,["onClick","loading"])]),_:1},8,["model","rules"])}}}),se=$(te,[["__scopeId","data-v-90c5410c"]]),ae=i=>(F("data-v-bae27a5d"),i=i(),L(),i),re={class:"br-5 overhide login-wrapper flex"},le={class:"login-right flex-yc w-100 p-3 pr"},ie=ae(()=>m("div",{class:"theme-overlay wh-100 pa inset-0"},null,-1)),ne=E({__name:"register",setup(i){const a=C(),v=H();return(w,c)=>{const d=j,u=se,o=O,g=D;return R(),P("div",{class:"login-page-wrapper flex-center pr",style:Q({backgroundImage:`url(${e(v).theme.login_bg})`})},[m("div",re,[t(d),m("div",le,[t(u,{class:"w-100"}),t(g,{class:"box-item",effect:"dark",content:"返回首页"},{default:n(()=>[m("div",{onClick:c[0]||(c[0]=h=>e(a).push("/")),class:"close curp hvco muted-color"},[t(o,{name:"home-5-line",size:"22"})])]),_:1})])]),ie],4)}}}),De=$(ne,[["__scopeId","data-v-bae27a5d"]]);export{De as default};

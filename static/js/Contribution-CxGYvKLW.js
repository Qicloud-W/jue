import{g as N,c as R,l as A,m as O,n as P}from"./element-plus-DEgQ78-a.js";import{_ as H,d as Q}from"./index-CYWUNeU5.js";import{d as U,bE as X,i as Z,m as j,b as q,o as c,c as u,W as S,O as m,a as r,V as g,aa as p,u as D,U as f,S as C,M as $,Q as G,a0 as I,P as J,X as K,bn as W,bl as M}from"./@vue-AVcRlItG.js";const b=864e5;var B=(e=>(e[e["1月"]=1]="1月",e[e["2月"]=2]="2月",e[e["3月"]=3]="3月",e[e["4月"]=4]="4月",e[e["5月"]=5]="5月",e[e["6月"]=6]="6月",e[e["7月"]=7]="7月",e[e["8月"]=8]="8月",e[e["9月"]=9]="9月",e[e["10月"]=10]="10月",e[e["11月"]=11]="11月",e[e["12月"]=12]="12月",e))(B||{}),L=(e=>(e[e.日=0]="日",e[e.一=1]="一",e[e.二=2]="二",e[e.三=3]="三",e[e.四=4]="四",e[e.五=5]="五",e[e.六=6]="六",e))(L||{});function x(e){const t=new Date(e);return{year:t.getFullYear(),month:t.getMonth()+1,date:t.getDate(),day:t.getDay(),full:_(t)}}function ee(e){const o=new Date(e),a=o.getDay(),l=o.getTime()-b*a,s=b*52*7;return new Date(l-s)}function te(e,t){const o=new Date(e),a=o.getDay(),l=[[],[],[],[],[],[],[]];for(let n=0;n<a;n++){const d=x(o.getTime()-(a-n)*b);l[d.day].push({ignore:!0,...d})}const s=new Date(t);for(let n=o.getTime();n<=s.getTime();n+=b){const d=x(n);l[d.day].push(d)}return l}function se(e){const t=new Map,o=e[0],a=e[e.length-1];return o.forEach((l,s)=>{let n=l;s===0&&l.month!==a[0].month&&(n=a[0]);const d=`${n.year}-${n.month}`,y=t.get(d)||{colspan:0,month:n.month,year:n.year};y.colspan++,t.set(d,y)}),[...t.values()]}function oe(...e){let t,o;if(e.length===1){const[l]=e;t=_(`${l}-01-01`),o=_(`${l}-12-31`)}else e.length===2?[t,o]=[_(e[0]),_(e[1])]:(o=_(Date.now()),t=_(ee(o)));const a=te(t,o);return{months:se(a),dates:a}}function w(e,t=2){return`${e}`.padStart(t,"0")}function _(e,t="yyyy-MM-dd"){const o=new Date(e),a=o.getFullYear(),l=o.getMonth()+1,s=o.getDate(),n=o.getHours(),d=o.getMinutes(),y=o.getSeconds();return t.replace("yyyy",`${a}`).replace("MM",`${w(l)}`).replace("dd",`${w(s)}`).replace("hh",`${w(n)}`).replace("mm",`${w(d)}`).replace("ss",`${w(y)}`)}const ne=e=>(W("data-v-ca8dd640"),e=e(),M(),e),ae={class:"contribution-chart w-100"},le={class:"thead no-select"},re=ne(()=>r("th",{id:"first-block"},null,-1)),ce=["colspan"],de={class:"tbody"},ue={class:"label",style:{"padding-right":"20px"}},ie={key:0},fe={class:"fs-12"},me=["data-date"],_e={class:"flex-yc curp fs-12"},ye=["onClick"],he={class:"colors"},ge={class:"less-text"},pe={class:"more-text"},De=U({__name:"Contribution",props:{year:{},yearList:{default:()=>[]},startDate:{},endDate:{},dataSources:{default:()=>({})},showFooter:{type:Boolean,default:!0},colors:{default:()=>["#9be9a8","#40c463","#30a14e","#216e39"]},lessText:{default:"少"},moreText:{default:"多"},size:{default:15}},setup(e){X(s=>({"58372f63":`${t.size}px`}));const t=e,o=Z(),a=j({year:0,months:[],dates:[]}),l={init:()=>{let s=[];t.startDate&&t.endDate?s=[t.startDate,t.endDate]:(t.year||a.year)&&(s=[t.year||a.year]);const n=oe(...s);a.months=n.months,a.dates=n.dates},handleChangeYear:s=>{a.year=s,l.init()},dateBackgroundColor:s=>{var n;return t.dataSources[s]?t.colors[((n=t.dataSources[s])==null?void 0:n.level)??0]:""}};return l.init(),q(()=>{setTimeout(()=>{o.value&&o.value.setScrollLeft(1e3)},40)}),(s,n)=>{var T;const d=N,y=R,k=H,F=A,z=O,V=P;return c(),u("div",ae,[S(y,{ref_key:"scrollRef",ref:o},{default:m(()=>[r("table",null,[r("thead",le,[r("tr",null,[re,(c(!0),u(g,null,p(D(a).months,i=>(c(),u("th",{colspan:i.colspan,class:"label"},[r("span",null,f(D(B)[i.month]),1)],8,ce))),256))])]),r("tbody",de,[(c(!0),u(g,null,p(D(a).dates,(i,v)=>(c(),u("tr",null,[r("td",ue,[v%2!==0?(c(),u("span",ie,f(D(L)[v]),1)):C("",!0)]),(c(!0),u(g,null,p(i,(h,Y)=>(c(),$(d,{class:"item",effect:"dark",placement:"top",key:Y,"open-delay":500,"show-after":50},{content:m(()=>{var E;return[r("div",null,f(h.full),1),r("div",fe,f((E=s.dataSources[h.full])==null?void 0:E.text),1)]}),default:m(()=>[r("td",{"data-date":h.full,class:G({hidden:h.ignore})},[r("div",{style:I({backgroundColor:l.dateBackgroundColor(h.full)}),class:"item-block"},null,4)],10,me)]),_:2},1024))),128))]))),256))])])]),_:1},512),s.showFooter?(c(),u("div",{key:0,class:"tfoot flex-sb flex-end",style:I({maxWidth:`${(s.size||0)*52+220}px`})},[!s.year&&s.yearList&&s.yearList.length?(c(),$(V,{key:0,teleported:!1,placement:"bottom",class:"w-100"},{dropdown:m(()=>[S(z,null,{default:m(()=>[(c(!0),u(g,null,p(s.yearList,i=>(c(),$(F,{key:i},{default:m(()=>[r("div",{onClick:v=>l.handleChangeYear(i),class:"fs-12"},f(i),9,ye)]),_:2},1024))),128))]),_:1})]),default:m(()=>[r("div",_e,[r("span",null,f(D(a).year||"选择年份"),1),S(k,{name:"arrow-down-s-line"})])]),_:1})):C("",!0),J(r("div",he,[r("span",ge,f(s.lessText),1),(c(!0),u(g,null,p(s.colors,i=>(c(),u("span",{class:"color-item",style:I([{backgroundColor:i,marginLeft:"4px"}])},null,4))),256)),r("span",pe,f(s.moreText),1)],512),[[K,(T=s.colors)==null?void 0:T.length]])],4)):C("",!0)])}}}),Se=Q(De,[["__scopeId","data-v-ca8dd640"]]);export{Se as _};

import{L as q,d as G,g as B,i as H,W as L,b as N,a as O,F as J,G as K,E as oe,_ as le}from"./element-plus-DEgQ78-a.js";import{H as se,I as R,n as k,c as Q,_ as T}from"./index-CYWUNeU5.js";import{b as X}from"./@vueuse-80B0Z04t.js";import{d as W,i as b,m as Y,ar as Z,o as y,c as j,P as ee,M as S,O as o,W as e,u as t,j as E,a as n,T as v,S as te}from"./@vue-AVcRlItG.js";import"./lodash-es-25cZ6aDd.js";import"./async-validator-DKvM95Vc.js";import"./dayjs-D7ajE0Qg.js";import"./clipboard-CJr-i2j9.js";import"./@element-plus-Bh_lnI-E.js";import"./@ctrl-r5W6hzzQ.js";import"./@popperjs-D9SI2xQl.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./pinia-DsZbUfLd.js";import"./pinia-plugin-persistedstate-n2tMOXAx.js";import"./axios-BdQ6k-vz.js";import"./nprogress-Dnjw-PvA.js";import"./vue-router-MJGgZ6ro.js";import"./markdown-it-4Tp5vWU9.js";import"./mdurl-k9Sl0PQj.js";import"./uc.micro-XL2UFyD4.js";import"./entities-C20TfXL6.js";import"./linkify-it-BpOB9kmn.js";import"./punycode.js-Dj65hjkv.js";import"./crypto-js-BOfVfFwP.js";import"./vue3-danmaku-DA_6354Q.js";import"./plyr-DMguYs3u.js";import"./viewerjs-ul8fLQ7-.js";import"./highlight.js-DnQT8WiG.js";import"./@unhead-CE7b8z0V.js";import"./unhead-BIJBGSS1.js";import"./hookable-B8xFkYCm.js";class ne{cache(u){return R.get("/api/toml/cache",{name:u})}testRedis(u,_,i,d){return R.post("/api/toml/test-redis",{host:u,database:_,port:i,password:d})}default(u,_){return R.put("/api/toml/cache-default",{value:u,open:_},!0)}redis(u,_,i,d,r,h){return R.put("/api/toml/cache-redis",{host:u,database:_,port:i,password:d,prefix:r,expire:h},!0)}file(u,_,i){return R.put("/api/toml/cache-file",{path:u,prefix:_,expire:i},!0)}ram(u){return R.put("/api/toml/cache-ram",{expire:u},!0)}clear(){return R.delete("/api/cache/clear")}}const x=new(se(ne)),ie={class:"config-ram-card-wrapper"},de={class:"flex-sb"},ce={class:"flex-yc"},re=n("span",{class:"fs-14"},"内存缓存",-1),pe={class:"flex-yc g-1"},ue=n("span",{class:"fs-12"},"已开启",-1),me=n("p",{class:"mt-2 fs-12 muted-color"}," 1. 开启后会对API数据进行缓存，减少重复执行数据库操作以及对数据的运算， 从而提高API的响应速度，减少服务器的负担。 ",-1),_e=n("p",{class:"mt-1 fs-12 muted-color"},"2. PS：缓存数据会通过内存的方式存储在服务器的内存中。",-1),fe={class:"flex-sb mt-4 w-100 z-1"},he={class:"dialog-footer"},ve=W({__name:"CacheRam",emits:["update"],setup(M,{expose:u,emit:_}){const i=b(!1),d=b(!1),r=b(!1),{width:h}=X(),p=Y({expire:""}),l=_,g={fetchData:async()=>{const s=await x.cache("ram");s.code===200&&(i.value=s.data.default==="ram"&&s.data.open,p.expire=s.data.expire)},handleChange:async()=>{r.value=!0;const s=await x.default("ram",!i.value);return r.value=!1,k(s),s.code===200&&l("update"),s.code===200},handleSave:async()=>{r.value=!0;const s=await x.ram(p.expire);r.value=!1,d.value=!1,k(s)}};return u({fetchData:g.fetchData}),g.fetchData(),(s,a)=>{const c=Q,D=T,I=B,P=H,F=L,C=N,$=q,U=O,V=J,w=K,z=G,A=Z("ripple");return y(),j("div",ie,[ee((y(),S($,{shadow:"never",class:"hover-up h-100 pr"},{default:o(()=>[e(c,{name:"d-8",class:"config-icon trf",size:"150"}),n("div",null,[n("div",de,[e(I,{placement:"top"},{content:o(()=>[v(" 推荐开启，有利于减少数据库和服务器的负担！ ")]),default:o(()=>[n("div",ce,[e(D,{name:"information-fill",class:"mr5"}),re])]),_:1}),t(i)?(y(),S(P,{key:0,type:"success"},{default:o(()=>[n("div",pe,[e(D,{size:"14",name:"checkbox-circle-line"}),ue])]),_:1})):te("",!0)]),me,_e]),n("div",fe,[e(F,{modelValue:t(i),"onUpdate:modelValue":a[0]||(a[0]=m=>E(i)?i.value=m:null),disabled:"","before-change":g.handleChange,loading:t(r)},null,8,["modelValue","before-change","loading"]),e(C,{plain:"",size:"small",type:"primary",onClick:a[1]||(a[1]=m=>d.value=!t(d))},{default:o(()=>[v("点我配置")]),_:1})])]),_:1})),[[A]]),e(z,{modelValue:t(d),"onUpdate:modelValue":a[4]||(a[4]=m=>E(d)?d.value=m:null),width:"95%",title:"文件缓存配置"},{footer:o(()=>[n("span",he,[e(C,{onClick:a[3]||(a[3]=m=>d.value=!1)},{default:o(()=>[v("取消")]),_:1}),e(C,{loading:t(r),type:"primary",onClick:g.handleSave},{default:o(()=>[v(" 确认 ")]),_:1},8,["loading","onClick"])])]),default:o(()=>[e(w,{model:t(p),"label-width":"100","label-position":t(h)<=768?"top":"left"},{default:o(()=>[e(V,{label:"过期时间(秒)"},{default:o(()=>[e(U,{modelValue:t(p).expire,"onUpdate:modelValue":a[2]||(a[2]=m=>t(p).expire=m),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","label-position"])]),_:1},8,["modelValue"])])}}}),ge={class:"config-file-card-wrapper"},be={class:"flex-sb"},xe={class:"flex-yc"},Ve=n("span",{class:"fs-14"},"文件缓存",-1),we={class:"flex-yc g-1"},ye=n("span",{class:"fs-12"},"已开启",-1),Ce=n("p",{class:"mt-2 fs-12 muted-color"}," 1. 开启后会对API数据进行缓存，减少重复执行数据库操作以及对数据的运算， 从而提高API的响应速度，减少服务器的负担。 ",-1),$e=n("p",{class:"mt-1 fs-12 muted-color"},[v(" 2. PS：缓存数据会通过文件的方式存储在服务器的 "),n("code",null,"runtime/cache"),v(" 目录下。 ")],-1),ke={class:"flex-sb mt-4 w-100 z-1"},De={class:"dialog-footer"},Ue=W({__name:"CacheFile",emits:["update"],setup(M,{expose:u,emit:_}){const i=b(!1),d=b(!1),r=b(!1),{width:h}=X(),p=Y({path:"",prefix:"",expire:""}),l=_,g={fetchData:async()=>{const s=await x.cache("file");s.code===200&&(i.value=s.data.default==="file"&&s.data.open,p.path=s.data.path,p.prefix=s.data.prefix,p.expire=s.data.expire)},handleChange:async()=>{r.value=!0;const s=await x.default("file",!i.value);return r.value=!1,k(s),s.code===200&&l("update"),s.code===200},handleSave:async()=>{r.value=!0;const s=await x.file(p.path,p.prefix,p.expire);r.value=!1,d.value=!1,k(s)}};return u({fetchData:g.fetchData}),g.fetchData(),(s,a)=>{const c=Q,D=T,I=B,P=H,F=L,C=N,$=q,U=O,V=J,w=K,z=G,A=Z("ripple");return y(),j("div",ge,[ee((y(),S($,{shadow:"never",class:"hover-up h-100 pr"},{default:o(()=>[e(c,{name:"d-7",class:"config-icon trf",size:"150"}),n("div",null,[n("div",be,[e(I,{placement:"top"},{content:o(()=>[v(" 推荐开启，有利于减少数据库和服务器的负担！ ")]),default:o(()=>[n("div",xe,[e(D,{name:"information-fill",class:"mr5"}),Ve])]),_:1}),t(i)?(y(),S(P,{key:0,type:"success"},{default:o(()=>[n("div",we,[e(D,{size:"14",name:"checkbox-circle-line"}),ye])]),_:1})):te("",!0)]),Ce,$e]),n("div",ke,[e(F,{modelValue:t(i),"onUpdate:modelValue":a[0]||(a[0]=m=>E(i)?i.value=m:null),"before-change":g.handleChange,loading:t(r)},null,8,["modelValue","before-change","loading"]),e(C,{plain:"",size:"small",type:"primary",onClick:a[1]||(a[1]=m=>d.value=!t(d))},{default:o(()=>[v("点我配置")]),_:1})])]),_:1})),[[A]]),e(z,{modelValue:t(d),"onUpdate:modelValue":a[6]||(a[6]=m=>E(d)?d.value=m:null),width:"95%",title:"文件缓存配置"},{footer:o(()=>[n("span",De,[e(C,{onClick:a[5]||(a[5]=m=>d.value=!1)},{default:o(()=>[v("取消")]),_:1}),e(C,{loading:t(r),type:"primary",onClick:g.handleSave},{default:o(()=>[v(" 确认 ")]),_:1},8,["loading","onClick"])])]),default:o(()=>[e(w,{model:t(p),"label-width":"100","label-position":t(h)<=768?"top":"left"},{default:o(()=>[e(V,{label:"缓存目录"},{default:o(()=>[e(U,{modelValue:t(p).path,"onUpdate:modelValue":a[2]||(a[2]=m=>t(p).path=m),clearable:""},null,8,["modelValue"])]),_:1}),e(V,{label:"过期时间(秒)"},{default:o(()=>[e(U,{modelValue:t(p).expire,"onUpdate:modelValue":a[3]||(a[3]=m=>t(p).expire=m),clearable:""},null,8,["modelValue"])]),_:1}),e(V,{label:"前缀"},{default:o(()=>[e(U,{modelValue:t(p).prefix,"onUpdate:modelValue":a[4]||(a[4]=m=>t(p).prefix=m),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","label-position"])]),_:1},8,["modelValue"])])}}}),Re={class:"config-redis-card-wrapper"},Ie={class:"flex-sb"},ze={class:"flex-yc"},Se=n("span",{class:"fs-14"},"Redis缓存",-1),Ee={class:"flex-yc g-1"},Pe=n("span",{class:"fs-12"},"已开启",-1),Fe=n("p",{class:"mt-2 fs-12 muted-color"}," 1. 开启后会对API数据进行缓存，减少重复执行数据库操作以及对数据的运算， 从而提高API的响应速度，减少服务器的负担。 ",-1),Ae=n("p",{class:"mt-1 fs-12 muted-color"},"2. PS：缓存数据会存储在专门的缓存数据库Redis中。",-1),Me={class:"flex-sb mt-4 w-100 z-1"},Be={class:"flex-yc"},Ne={class:"dialog-footer"},Te=W({__name:"CacheRedis",emits:["update"],setup(M,{expose:u,emit:_}){const i=b(!1),d=b(!1),r=b(!1),h=b(!1),{width:p}=X(),l=Y({host:"",port:6379,database:0,password:"",prefix:"",expire:""}),g=_,s={fetchData:async()=>{const a=await x.cache("redis");a.code===200&&(i.value=a.data.default==="redis"&&a.data.open,l.expire=a.data.expire,l.password=a.data.password,l.prefix=a.data.prefix,l.host=a.data.host,l.port=a.data.port,l.database=a.data.database)},handleChange:async()=>{if(!i.value&&!h.value)return oe.warning("请先通过redis连接测试"),!1;r.value=!0;const a=await x.default("redis",!i.value);return r.value=!1,k(a),a.code===200&&g("update"),a.code===200},handleSave:async()=>{r.value=!0;const a=await x.redis(l.host,l.database,l.port,l.password,l.prefix,l.expire);r.value=!1,d.value=!1,k(a)},testRedis:async()=>{const a=await x.testRedis(l.host,l.database,l.port,l.password);a.code===200&&(h.value=!0),k(a)}};return u({fetchData:s.fetchData}),s.fetchData(),(a,c)=>{const D=Q,I=T,P=B,F=H,C=L,$=N,U=q,V=O,w=J,z=le,A=K,m=G,ae=Z("ripple");return y(),j("div",Re,[ee((y(),S(U,{shadow:"never",class:"hover-up h-100 pr"},{default:o(()=>[e(D,{name:"d-9",class:"config-icon trf",size:"150"}),n("div",null,[n("div",Ie,[e(P,{placement:"top"},{content:o(()=>[v(" 推荐开启，有利于减少数据库和服务器的负担！ ")]),default:o(()=>[n("div",ze,[e(I,{name:"information-fill",class:"mr5"}),Se])]),_:1}),t(i)?(y(),S(F,{key:0,type:"success"},{default:o(()=>[n("div",Ee,[e(I,{size:"14",name:"checkbox-circle-line"}),Pe])]),_:1})):te("",!0)]),Fe,Ae]),n("div",Me,[e(C,{modelValue:t(i),"onUpdate:modelValue":c[0]||(c[0]=f=>E(i)?i.value=f:null),"before-change":s.handleChange,loading:t(r)},null,8,["modelValue","before-change","loading"]),n("div",Be,[e($,{onClick:s.testRedis,size:"small",type:"success",plain:""},{default:o(()=>[v("测试连接")]),_:1},8,["onClick"]),e($,{plain:"",size:"small",type:"primary",onClick:c[1]||(c[1]=f=>d.value=!t(d))},{default:o(()=>[v("点我配置")]),_:1})])])]),_:1})),[[ae]]),e(m,{modelValue:t(d),"onUpdate:modelValue":c[9]||(c[9]=f=>E(d)?d.value=f:null),width:"95%",title:"Redis配置"},{footer:o(()=>[n("span",Ne,[e($,{onClick:c[8]||(c[8]=f=>d.value=!1)},{default:o(()=>[v("取消")]),_:1}),e($,{loading:t(r),type:"primary",onClick:s.handleSave},{default:o(()=>[v(" 确认 ")]),_:1},8,["loading","onClick"])])]),default:o(()=>[e(A,{model:t(l),"label-width":"100","label-position":t(p)<=768?"top":"left"},{default:o(()=>[e(w,{label:"主机"},{default:o(()=>[e(V,{modelValue:t(l).host,"onUpdate:modelValue":c[2]||(c[2]=f=>t(l).host=f),clearable:""},null,8,["modelValue"])]),_:1}),e(w,{label:"端口"},{default:o(()=>[e(z,{modelValue:t(l).port,"onUpdate:modelValue":c[3]||(c[3]=f=>t(l).port=f)},null,8,["modelValue"])]),_:1}),e(w,{label:"数据库"},{default:o(()=>[e(z,{modelValue:t(l).database,"onUpdate:modelValue":c[4]||(c[4]=f=>t(l).database=f)},null,8,["modelValue"])]),_:1}),e(w,{label:"密码"},{default:o(()=>[e(V,{modelValue:t(l).password,"onUpdate:modelValue":c[5]||(c[5]=f=>t(l).password=f),type:"password",clearable:"","show-password":""},null,8,["modelValue"])]),_:1}),e(w,{label:"过期时间(秒)"},{default:o(()=>[e(V,{modelValue:t(l).expire,"onUpdate:modelValue":c[6]||(c[6]=f=>t(l).expire=f),clearable:""},null,8,["modelValue"])]),_:1}),e(w,{label:"前缀"},{default:o(()=>[e(V,{modelValue:t(l).prefix,"onUpdate:modelValue":c[7]||(c[7]=f=>t(l).prefix=f),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","label-position"])]),_:1},8,["modelValue"])])}}}),We={class:"admin-system-cache-page box-card cus-box-card",shadow:"never"},je={class:"config-wrapper grid g-6"},xt=W({__name:"index",setup(M){const u=b(),_=b(),i=b(),d={clearCache:async()=>{const r=await x.clear();k(r)}};return(r,h)=>{const p=Te,l=Ue,g=ve,s=T,a=N,c=B;return y(),j("div",We,[n("div",je,[e(p,{ref_key:"redisRef",ref:u,onUpdate:h[0]||(h[0]=()=>{t(_).fetchData(),t(i).fetchData()})},null,512),e(l,{ref_key:"fileRef",ref:_,onUpdate:h[1]||(h[1]=()=>{t(u).fetchData(),t(i).fetchData()})},null,512),e(g,{ref_key:"ramRef",ref:i,onUpdate:h[2]||(h[2]=()=>{t(u).fetchData(),t(_).fetchData()})},null,512)]),e(c,{effect:"dark",content:"清除缓存",placement:"left-start"},{default:o(()=>[e(a,{class:"clear-cache",type:"success",circle:"",onClick:d.clearCache},{default:o(()=>[e(s,{name:"refresh-line",size:"20"})]),_:1},8,["onClick"])]),_:1})])}}});export{xt as default};
